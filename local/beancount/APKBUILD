# Contributor: Keith Maxwell <keith.maxwell@gmail.com>
# Maintainer: Keith Maxwell <keith.maxwell@gmail.com>
pkgname=beancount
pkgver=2.1.3
pkgrel=0
pkgdesc="Double-Entry Accounting from Text Files"
url="http://furius.ca/beancount/"
arch="x86_64"
license="GPL-2.0-only"
depends="python3 py3-dateutil py3-ply py3-bottle py3-lxml py3-magic
	py3-beautifulsoup4 py3-requests py3-chardet
	py3-google-api-python-client"
makedepends="python3-dev py3-setuptools"
checkdepends="py3-pytest"
source="$pkgname-$pkgver.tar.gz::https://bitbucket.org/blais/beancount/get/$pkgver.tar.gz"

prepare() {
       cd "$srcdir"
       mv blais-$pkgname-???????????? "$pkgname-$pkgver"
       default_prepare
}

build() {
	cd "$builddir"
	python3 setup.py build
	python3 setup.py build_ext -i
}

package() {
	cd "$builddir"
	python3 setup.py install --prefix=/usr --root="$pkgdir"
}

check() {
	cd "$builddir"
	python3 -m pytest beancount -k 'not test_xhtml and not test_include_encrypted'
}

sha512sums="3f214b92673081e3621df71829efd0b42c99fb0cb93ea610fcba3d403a7975e7caf989a39fa2b6e0ad13a0cc55d97483560912de7f957affffc2e276aac3c305  beancount-2.1.3.tar.gz"
